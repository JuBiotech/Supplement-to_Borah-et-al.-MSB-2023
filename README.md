Supplementary information to 

# One-shot <sup>13</sup>C<sup>15</sup>N-metabolic flux analysis for simultaneous quantification of carbon and nitrogen flux

Khushboo Borah Slater<sup>1,¶</sup>, Martin Beyß<sup>2,3,¶</sup>, Ye Xu<sup>1</sup>, Jim Barber<sup>1</sup>, Catia Costa<sup>4</sup>, Jane Newcombe<sup>1</sup>, Axel Theorell<sup>2,5</sup>, Melanie J Bailey<sup>4</sup>, Dany JV Beste<sup>1</sup>, Johnjoe McFadden<sup>1,¶,\*</sup>, Katharina Nöh<sup>2,¶,\*</sup>

<sup>1</sup> Faculty of Health and Medical Sciences, University of Surrey, UK, GU2 7XH

<sup>2</sup> Forschungszentrum Jülich GmbH, Institute of Bio- and Geosciences, IBG-1: Biotechnology, 52425 Jülich, Germany

<sup>3</sup> RWTH Aachen University, Computational Systems Biotechnology, 52062 Aachen, Germany

<sup>4</sup> Faculty of Engineering and Physical Sciences, University of Surrey, UK, GU2 7XH

<sup>5</sup> Current address: Computational Systems Biology, ETH Zürich, 4058 Basel, Switzerland

<sup>¶</sup> These authors contributed equally to this work

<sup>\*</sup> Correspondence email address: j.mcfadden@surrey.ac.uk; k.noeh@fz-juelich.de


## Contents

- `x3cflux-bma-1.0.0-Ubuntu2204.deb` **B**ayesian **M**odel **A**veraging extension to the high-performance simulator 13CFLUX2. 
  Precondition of use: a functional installation of 13CFLUX2 (Ubuntu 22.04.).
- `CN_network_model_BCG.fml` FluxML model of BCG used for the analysis including reactions, CN atom transitions, constraints, and data
- `run.sh` shell script to execute Bayesian Model Averaging in parallel (50 parallel processes) with parameters described in the publication
- `seeds.txt` the seeds used for producing the results
- `run_seeds.sh` shell script to execute Bayesian Model Averaging as described before, but uses the file `seeds.txt` for the seeds. Executing the script Will reproduce the samples analyzed in the publication.
- `README.md` this document. Guide to `x3cflux-bma`.

## Usage

To reproduce the samples from the publication the following is needed:

- 13CFLUX2 version 2.3 or newer. 13CFLUX2 is available free of charge for non-commercial academic and research purposes. Further details are available at the 13CFLUX2 [website](https://13cflux.net/13cflux2/license.jsp).
- Bayesian Model Averaging extension to 13CFLUX2, which is available in this repository for Ubuntu 22.04.

Clone the repository and execute either `run_seeds.sh` (to use the same seeds as used in the publication) or `run.sh` (to use new seeds).

## Parameters to `x3cflux-bma`

| CLI parameter | description | value used in publication |
|---------------|-------------|---------------------------|
| `--thinning <int>` | Save only each thinning datapoint to decrease size on disc of saved data (default: 1)| **2000** |
| `--fullInfo <bool>` | Save independent and dependent states, simulated measurements and likelihoods (default: false) | **1** |
| `-o <HDF5 file>,  --output <HDF5 file>` | (required)  File name of HDF5 output file | autogenerated from script |
| `--start-fml` | Starts all chains from the flux distribution of the FML file (default: disabled) | - |
| `-j <int>,  --jobs <int>` | Number of jobs (default: number of virtual cores) | 12 (does impact runtime, but not results) |
| `--seed <int>` | Random number generator seed (default: current time) | - (the seeds uses are available in `seeds.txt`) |
| `--chains <int>` | Number of chains (default: 20) | **30** |
| `-p <double>,  --pw <double>` | Width of proposal Gaussian in RW (default: 2.5) | **50** |
|` -b <int>,  --burnin <int>` | Number of burnin samples (default: 20000) | **5,000,000** |
| `-n <int>,  --samples <int>` | Number of samples, excluding burn in (default: 10000) | **10,000,000** |
| `-i <FML>,  --input <FML>` | (required)  FML file | autogenerated from script |


## interpreting results

`x3cflux-bma` produces `hdf5` files. Relevant for the evaluation are the data in the `samples` branch

- `likelihoods` likelihood (SSR/2) of sample
- `states` the samples, i.e. values of the free fluxes; exchange fluxes are scaled to [0, 1]
- `coIs` names of the free fluxes
- `netFluxes` values of all net fluxes
- `allFluxCoIs` names of all net fluxes
